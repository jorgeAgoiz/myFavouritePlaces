<%- include('includes/head.ejs') %>
<div class="container-fluid">
  <%- include('includes/navbar.ejs') %> <% places.forEach( place => { %>

  <div class="row align-items-center justify-content-center">
    <div
      class="col-12 col-sm-10 col-md-8 text-center mt-4 mb-4 pt-3 pb-3 placeCard"
    >
      <div class="row align-items-center justify-content-center">
        <div class="col-12 pt-1 pb-1 mt-1 mb-1">
          <h1><%= place.name %></h1>
        </div>
        <div class="col-12 pt-1 pb-1 mt-1 mb-1">
          <h2><%= place.direction %></h2>
        </div>
        <div class="col-12 pt-1 pb-1 mt-1 mb-1">
          <p><%= place.comments %></p>
        </div>
        <div class="col-6">
          <form action="/editplace" method="POST">
            <input type="hidden" name="collectId" value="<%= collectId %>" />
            <input type="hidden" name="placeId" value="<%= place._id %>" />
            <button class="btn btnStyleThree" type="submit">Edit Place</button>
          </form>
        </div>

        <div class="col-6">
          <form action="/deleteplace" method="POST">
            <input type="hidden" name="collectId" value="<%= collectId %>" />
            <input type="hidden" name="placeId" value="<%= place._id %>" />
            <button class="btn btnStyleThree" type="submit">
              Delete Place
            </button>
          </form>
        </div>
        <div class="col-4" id="mapid"></div>
      </div>
    </div>
  </div>

  <script>
    let map;
    let lat = "<%= place.latitude %>";
    let latNum = parseFloat(lat);
    let lng = "<%= place.length %>";
    let lngNum = parseFloat(lng);
    let mymap = L.map("mapid").setView([latNum, lngNum], 15);

    L.tileLayer(
      "https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",
      {
        attribution:
          'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
        maxZoom: 18,
        id: "mapbox/outdoors-v11",
        tileSize: 512,
        zoomOffset: -1,
        accessToken: "<%= mapBox %>",
      }
    ).addTo(mymap);
    var marker = L.marker([latNum, lngNum]).addTo(mymap);
  </script>

  <% }) %>
</div>

<%- include('includes/end.ejs') %>
